// ==UserScript==
// @author          Oleg Valter <oleg.a.valter@gmail.com>
// @description     adds a garbage bin icon to custom filters
// @grant           none
// @homepage        https://github.com/userscripters/garbage-filters#readme
// @match           https://*.askubuntu.com/*
// @match           https://*.mathoverflow.net/*
// @match           https://*.serverfault.com/*
// @match           https://*.stackapps.com/*
// @match           https://*.stackexchange.com/*
// @match           https://*.stackoverflow.com/*
// @name            Garbage Filters
// @namespace       userscripters
// @run-at          document-start
// @source          git+https://github.com/userscripters/garbage-filters.git
// @supportURL      https://github.com/userscripters/garbage-filters/issues
// @version         0.1.0
// ==/UserScript==

"use strict";var __awaiter=this&&this.__awaiter||function(t,o,s,l){return new(s=s||Promise)(function(r,e){function n(t){try{i(l.next(t))}catch(t){e(t)}}function a(t){try{i(l.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?r(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(n,a)}i((l=l.apply(t,o||[])).next())})},__generator=this&&this.__generator||function(r,n){var a,i,o,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,i&&(o=2&e[0]?i.return:e[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,e[1])).done)return o;switch(i=0,(e=o?[2&e[0],o.value]:e)[0]){case 0:case 1:o=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,i=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(o=0<(o=s.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){s.label=e[1];break}if(6===e[0]&&s.label<o[1]){s.label=o[1],o=e;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(e);break}o[2]&&s.ops.pop(),s.trys.pop();continue}e=n.call(r,s)}catch(t){e=[6,t],i=0}finally{a=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},__read=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,a,i=r.call(t),o=[];try{for(;(void 0===e||0<e--)&&!(n=i.next()).done;)o.push(n.value)}catch(t){a={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o},__spreadArray=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,a=0,i=e.length;a<i;a++)!n&&a in e||((n=n||Array.prototype.slice.call(e,0,a))[a]=e[a]);return t.concat(n||Array.prototype.slice.call(e))};!function(t,e,o){var r={more:"uql-more-popover"},n={custom:"a[href*='uqlId=']"};t.addEventListener("load",function(){var t=e.getElementById(r.more);if(!t)return console.debug('missing "more" container');t.querySelectorAll(n.custom).forEach(function(t){var e,r,n,a,i,o,s,l,c=t.href,d=t.text,u=__read(/uqlId=(\d+)/.exec(c)||[],2)[1];u&&(l=d.trim(),e=__read(function(t,e,r){var n=void 0===r?{}:r,a=n.classes,i=void 0===a?[]:a,o=n.width,s=void 0===o?14:o,r=n.height,a=void 0===r?s:r,o="http://www.w3.org/2000/svg",n=document.createElementNS(o,"svg");(r=n.classList).add.apply(r,__spreadArray(["svg-icon",t],__read(i),!1)),n.setAttribute("width",s.toString()),n.setAttribute("height",a.toString()),n.setAttribute("viewBox","0 0 "+s+" "+a),n.setAttribute("aria-hidden","true");o=document.createElementNS(o,"path");return o.setAttribute("d",e),n.append(o),[n,o]}("iconTrash","M11 2a1 1 0 011 1v1H2V3a1 1 0 011-1h2a1 1 0 011-1h2a1 1 0 011 1h2Zm0 3H3v6c0 1.1.9 2 2 2h4a2 2 0 002-2V5Z"),1)[0],r="uqlId-"+u,o=(i=void 0===(a={danger:!(n=""),title:"Delete "+l,type:"link"})?{}:a).classes,s=void 0===o?[]:o,c=i.title,d=i.danger,u=void 0!==d&&d,l=i.loading,a=void 0!==l&&l,o=i.muted,d=void 0!==o&&o,l=i.primary,o=void 0!==l&&l,l=i.type,i=void 0===l?"filled":l,(l=document.createElement("button")).id=r,l.textContent=n,(r=l.classList).add.apply(r,__spreadArray(["s-btn","s-btn__"+i],__read(s),!1)),l.setAttribute("role","button"),l.setAttribute("aria-label",c||n),u&&l.classList.add("s-btn__danger"),d&&l.classList.add("s-btn__muted"),o&&l.classList.add("s-btn__primary"),a&&l.classList.add("is-loading"),c&&(l.title=c),(l=l).append(e),t.append(l),t.classList.add("d-flex","ai-center","jc-space-between"))}),t.addEventListener("click",function(i){return __awaiter(void 0,void 0,void 0,function(){var e,a;return __generator(this,function(t){switch(t.label){case 0:return(e=i.target,a=e.closest("button"),e=__read((null==a?void 0:a.id.split("-"))||[],2),a=e[0],e=e[1],console.log({prefix:a,id:e}),"uqlId"!==a)?[2]:(a=StackExchange.options.user.fkey,i.preventDefault(),(new FormData).append("fkey",a),[4,(r=e,n=a,__awaiter(void 0,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return(e=new FormData).append("fkey",n),[4,fetch("https://"+o.hostname+"/questions/user-lists/"+r+"/delete",{method:"POST",body:e})];case 1:return[2,t.sent().ok]}})}))]);case 1:return t.sent()&&o.reload(),[2]}var r,n})})})})}(window,document,(localStorage,location));